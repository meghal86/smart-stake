<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hunter RiskIcon Fix Verification</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #0A0F1F;
      color: #E4E8F3;
    }
    .test-section {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .test-section h2 {
      margin-top: 0;
      color: #00F5A0;
    }
    .status {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 6px;
      font-weight: bold;
      font-size: 14px;
    }
    .status.pass {
      background: rgba(0, 245, 160, 0.2);
      color: #00F5A0;
    }
    .status.fail {
      background: rgba(239, 68, 68, 0.2);
      color: #EF4444;
    }
    .risk-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin: 8px 8px 8px 0;
    }
    .risk-low {
      background: rgba(16, 185, 129, 0.1);
      color: #10B981;
    }
    .risk-medium {
      background: rgba(251, 191, 36, 0.1);
      color: #FBBF24;
    }
    .risk-high {
      background: rgba(239, 68, 68, 0.1);
      color: #EF4444;
    }
    .icon {
      width: 14px;
      height: 14px;
    }
    pre {
      background: rgba(0,0,0,0.3);
      padding: 12px;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 13px;
    }
    .test-result {
      margin: 12px 0;
      padding: 12px;
      background: rgba(255,255,255,0.03);
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1>üéØ Hunter RiskIcon Fix Verification</h1>
  
  <div class="test-section">
    <h2>Test 1: RiskIcon Component Initialization</h2>
    <div id="test1"></div>
  </div>

  <div class="test-section">
    <h2>Test 2: Risk Badge Rendering</h2>
    <div id="test2"></div>
  </div>

  <div class="test-section">
    <h2>Test 3: Edge Cases</h2>
    <div id="test3"></div>
  </div>

  <div class="test-section">
    <h2>Test 4: Mock Data Validation</h2>
    <div id="test4"></div>
  </div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // Simulate Lucide icons
    const CheckCircle = ({ className }) => (
      <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
      </svg>
    );

    const AlertTriangle = ({ className }) => (
      <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
        <line x1="12" y1="9" x2="12" y2="13"></line>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
    );

    // Risk icon mapping (same as OpportunityCard.tsx)
    const riskIcons = {
      Low: CheckCircle,
      Medium: AlertTriangle,
      High: AlertTriangle
    };

    // Test 1: Component Initialization
    function Test1() {
      const [results, setResults] = useState([]);

      useEffect(() => {
        const testCases = [
          { riskLevel: 'Low', expected: 'CheckCircle' },
          { riskLevel: 'Medium', expected: 'AlertTriangle' },
          { riskLevel: 'High', expected: 'AlertTriangle' },
          { riskLevel: null, expected: 'AlertTriangle (fallback)' },
          { riskLevel: undefined, expected: 'AlertTriangle (fallback)' },
          { riskLevel: 'Invalid', expected: 'AlertTriangle (fallback)' }
        ];

        const testResults = testCases.map(test => {
          // Simulate the fixed initialization logic
          const RiskIcon = (test.riskLevel && riskIcons[test.riskLevel]) 
            ? riskIcons[test.riskLevel] 
            : riskIcons.Medium;

          const isValid = RiskIcon !== undefined && typeof RiskIcon === 'function';
          const componentName = RiskIcon === CheckCircle ? 'CheckCircle' : 'AlertTriangle';

          return {
            input: test.riskLevel || 'null/undefined',
            expected: test.expected,
            actual: componentName,
            pass: isValid && test.expected.includes(componentName)
          };
        });

        setResults(testResults);
      }, []);

      return (
        <div>
          {results.map((result, i) => (
            <div key={i} className="test-result">
              <span className={`status ${result.pass ? 'pass' : 'fail'}`}>
                {result.pass ? '‚úÖ PASS' : '‚ùå FAIL'}
              </span>
              <div style={{ marginTop: '8px' }}>
                <strong>Input:</strong> <code>{result.input}</code><br/>
                <strong>Expected:</strong> {result.expected}<br/>
                <strong>Actual:</strong> {result.actual}
              </div>
            </div>
          ))}
        </div>
      );
    }

    // Test 2: Risk Badge Rendering
    function Test2() {
      const opportunities = [
        { id: '1', riskLevel: 'Low', title: 'Ethereum Staking' },
        { id: '2', riskLevel: 'Medium', title: 'LayerZero Airdrop' },
        { id: '3', riskLevel: 'High', title: 'NFT Mint' }
      ];

      return (
        <div>
          <p>Visual verification of risk badges:</p>
          {opportunities.map(opp => {
            const RiskIcon = (opp.riskLevel && riskIcons[opp.riskLevel]) 
              ? riskIcons[opp.riskLevel] 
              : riskIcons.Medium;

            const colorClass = opp.riskLevel === 'Low' 
              ? 'risk-low' 
              : opp.riskLevel === 'Medium' 
                ? 'risk-medium' 
                : 'risk-high';

            return (
              <div key={opp.id} className={`risk-badge ${colorClass}`}>
                {RiskIcon && <RiskIcon className="icon" />}
                {opp.riskLevel?.toUpperCase() || 'UNKNOWN'} RISK - {opp.title}
              </div>
            );
          })}
        </div>
      );
    }

    // Test 3: Edge Cases
    function Test3() {
      const [results, setResults] = useState([]);

      useEffect(() => {
        const edgeCases = [
          { riskLevel: '', description: 'Empty string' },
          { riskLevel: 0, description: 'Number 0' },
          { riskLevel: false, description: 'Boolean false' },
          { riskLevel: {}, description: 'Empty object' },
          { riskLevel: [], description: 'Empty array' }
        ];

        const testResults = edgeCases.map(test => {
          try {
            const RiskIcon = (test.riskLevel && riskIcons[test.riskLevel]) 
              ? riskIcons[test.riskLevel] 
              : riskIcons.Medium;

            const isValid = RiskIcon !== undefined && typeof RiskIcon === 'function';

            return {
              description: test.description,
              input: JSON.stringify(test.riskLevel),
              result: isValid ? 'Valid component (fallback)' : 'Invalid',
              pass: isValid
            };
          } catch (error) {
            return {
              description: test.description,
              input: JSON.stringify(test.riskLevel),
              result: `Error: ${error.message}`,
              pass: false
            };
          }
        });

        setResults(testResults);
      }, []);

      return (
        <div>
          {results.map((result, i) => (
            <div key={i} className="test-result">
              <span className={`status ${result.pass ? 'pass' : 'fail'}`}>
                {result.pass ? '‚úÖ PASS' : '‚ùå FAIL'}
              </span>
              <div style={{ marginTop: '8px' }}>
                <strong>Edge Case:</strong> {result.description}<br/>
                <strong>Input:</strong> <code>{result.input}</code><br/>
                <strong>Result:</strong> {result.result}
              </div>
            </div>
          ))}
        </div>
      );
    }

    // Test 4: Mock Data Validation
    function Test4() {
      const mockOpportunities = [
        {
          id: '1',
          type: 'Staking',
          riskLevel: 'Low',
          title: 'Ethereum 2.0 Staking'
        },
        {
          id: '2',
          type: 'Airdrop',
          riskLevel: 'Medium',
          title: 'LayerZero Airdrop'
        },
        {
          id: '3',
          type: 'Quest',
          riskLevel: 'Low',
          title: 'Uniswap V4 Beta Testing'
        },
        {
          id: '4',
          type: 'NFT',
          riskLevel: 'High',
          title: 'Pudgy Penguins Mint'
        },
        {
          id: '5',
          type: 'Staking',
          riskLevel: 'Low',
          title: 'Solana Liquid Staking'
        }
      ];

      const validRiskLevels = ['Low', 'Medium', 'High'];
      const allValid = mockOpportunities.every(opp => 
        validRiskLevels.includes(opp.riskLevel)
      );

      return (
        <div>
          <div className="test-result">
            <span className={`status ${allValid ? 'pass' : 'fail'}`}>
              {allValid ? '‚úÖ ALL VALID' : '‚ùå INVALID DATA'}
            </span>
            <div style={{ marginTop: '12px' }}>
              <strong>Mock Opportunities Validation:</strong>
              <pre>{JSON.stringify(mockOpportunities.map(o => ({
                id: o.id,
                type: o.type,
                riskLevel: o.riskLevel,
                isValid: validRiskLevels.includes(o.riskLevel)
              })), null, 2)}</pre>
            </div>
          </div>
        </div>
      );
    }

    // Render all tests
    ReactDOM.render(<Test1 />, document.getElementById('test1'));
    ReactDOM.render(<Test2 />, document.getElementById('test2'));
    ReactDOM.render(<Test3 />, document.getElementById('test3'));
    ReactDOM.render(<Test4 />, document.getElementById('test4'));
  </script>

  <div class="test-section">
    <h2>üìã Summary</h2>
    <p>This test verifies that the RiskIcon component initialization fix works correctly:</p>
    <ul>
      <li>‚úÖ RiskIcon is always a valid component (never undefined)</li>
      <li>‚úÖ Fallback to Medium risk icon when riskLevel is invalid</li>
      <li>‚úÖ Conditional rendering prevents undefined component errors</li>
      <li>‚úÖ Mock data has valid riskLevel values</li>
      <li>‚úÖ Edge cases handled gracefully</li>
    </ul>
    <p><strong>Next Steps:</strong></p>
    <ol>
      <li>Hard refresh your browser (Ctrl+Shift+R or Cmd+Shift+R)</li>
      <li>Navigate to <code>/hunter</code> page</li>
      <li>Verify no console errors</li>
      <li>Verify all risk badges display correctly</li>
    </ol>
  </div>
</body>
</html>
