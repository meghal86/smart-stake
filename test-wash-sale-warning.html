<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wash Sale Warning Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #0A0E1A;
            color: white;
        }
        .warning-banner {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin: 20px 0;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        .warning-icon {
            color: #60A5FA;
            flex-shrink: 0;
            margin-top: 2px;
        }
        .warning-content h4 {
            color: #60A5FA;
            font-size: 14px;
            font-weight: 600;
            margin: 0 0 4px 0;
        }
        .warning-content p {
            color: rgba(147, 197, 253, 0.8);
            font-size: 14px;
            margin: 0 0 12px 0;
            line-height: 1.4;
        }
        .warning-tip {
            background: rgba(59, 130, 246, 0.1);
            border-radius: 6px;
            padding: 8px;
            margin-top: 12px;
        }
        .warning-tip p {
            color: #93C5FD;
            font-size: 12px;
            margin: 0;
        }
        .csv-preview {
            background: #1F2937;
            border: 1px solid #374151;
            border-radius: 8px;
            padding: 16px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 12px;
            overflow-x: auto;
        }
        .csv-preview h3 {
            margin: 0 0 12px 0;
            color: #F3F4F6;
        }
        .csv-line {
            margin: 2px 0;
            white-space: nowrap;
        }
        .csv-header {
            color: #60A5FA;
            font-weight: bold;
        }
        .csv-warning {
            color: #F59E0B;
            font-weight: bold;
        }
        .csv-data {
            color: #D1D5DB;
        }
    </style>
</head>
<body>
    <h1>üö® Wash Sale Warning System Test</h1>
    
    <p>This page demonstrates the wash sale warning system implementation for HarvestPro Task 9.1.</p>
    
    <h2>üìã Requirements Implemented</h2>
    <ul>
        <li>‚úÖ <strong>Enhanced Req 28 AC1:</strong> Display warning: "Wash sale rules may apply; consult a tax professional"</li>
        <li>‚úÖ <strong>Enhanced Req 28 AC3:</strong> Flag re-entry in export if occurred within configurable window</li>
        <li>‚úÖ <strong>Educational warning in detail modal</strong> (no detection engine needed since no rebuy/re-entry UI exists)</li>
    </ul>
    
    <h2>üé≠ Modal Warning Banner</h2>
    <p>This warning appears in the HarvestDetailModal for all harvest opportunities:</p>
    
    <div class="warning-banner">
        <div class="warning-icon">‚öñÔ∏è</div>
        <div class="warning-content">
            <h4>Tax Rule Reminder üìã</h4>
            <p>
                <strong>Wash sale rules may apply; consult a tax professional.</strong>
                Tax-loss harvesting involves complex regulations that can vary based on your situation. 
                This tool provides informational outputs only and does not constitute tax advice.
            </p>
            <div class="warning-tip">
                <p>
                    üí° <strong>Important:</strong> If you plan to repurchase the same or substantially identical assets within 30 days, 
                    wash sale rules may disallow the tax loss. Always verify with a qualified tax professional.
                </p>
            </div>
        </div>
    </div>
    
    <h2>üìä CSV Export Enhancement</h2>
    <p>The CSV export now includes wash sale warnings and flags:</p>
    
    <div class="csv-preview">
        <h3>Enhanced Form 8949 CSV Export</h3>
        <div class="csv-line csv-header">Accounting: FIFO, Not a tax filing</div>
        <div class="csv-line csv-warning">REMINDER: Monitor for repurchases within 30 days. Wash sale rules may apply.</div>
        <div class="csv-line"></div>
        <div class="csv-line csv-header">Description,Date Acquired,Date Sold,Proceeds,Cost Basis,Gain or Loss,Term,Quantity,Source,Tx Hash,Fee USD,Wash Sale Flag</div>
        <div class="csv-line csv-data">1.50000000 ETH,2024-01-15,2024-12-27,3000.00,4500.00,-1500.00,Short-term,1.50000000,Uniswap,0x1234...5678,85.00,"Monitor for repurchases within 30 days"</div>
        <div class="csv-line csv-data">5000.00000000 MATIC,2024-02-20,2024-12-27,2800.00,3472.00,-672.00,Short-term,5000.00000000,QuickSwap,0xabcd...efgh,92.00,"Monitor for repurchases within 30 days"</div>
    </div>
    
    <h2>üîß Technical Implementation</h2>
    <ul>
        <li><strong>Modal Warning:</strong> Added static educational warning in <code>HarvestDetailModal.tsx</code></li>
        <li><strong>Wash Sale Detection:</strong> Created <code>wash-sale-detection.ts</code> utility</li>
        <li><strong>CSV Enhancement:</strong> Updated <code>csv-export.ts</code> to include wash sale flags</li>
        <li><strong>Configurable Window:</strong> Default 30-day window (configurable)</li>
        <li><strong>Educational Content:</strong> Comprehensive wash sale education constants</li>
    </ul>
    
    <h2>‚öñÔ∏è Compliance Notes</h2>
    <div class="warning-banner">
        <div class="warning-icon">‚ö†Ô∏è</div>
        <div class="warning-content">
            <h4>Important Disclaimers</h4>
            <p>
                This implementation provides <strong>educational warnings only</strong> and does not constitute tax advice. 
                The wash sale detection is basic and for informational purposes. Users must consult qualified tax professionals 
                for actual wash sale determination and compliance.
            </p>
            <div class="warning-tip">
                <p>
                    <strong>Regulatory Compliance:</strong> Enhanced Req 28 AC4-5 ensure clear separation between 
                    "loss realization" and "portfolio strategy" and that re-entry timing is not presented as a recommendation.
                </p>
            </div>
        </div>
    </div>
    
    <h2>‚úÖ Task Completion Status</h2>
    <ul>
        <li>‚úÖ <strong>Static educational warning added to detail modal</strong></li>
        <li>‚úÖ <strong>Warning displays: "Wash sale rules may apply; consult a tax professional"</strong></li>
        <li>‚úÖ <strong>CSV export includes wash sale flags and warnings</strong></li>
        <li>‚úÖ <strong>Configurable 30-day window implemented</strong></li>
        <li>‚úÖ <strong>Educational content and disclaimers provided</strong></li>
        <li>‚úÖ <strong>Unit tests created and passing</strong></li>
    </ul>
    
    <p><strong>Task 9.1 Wash Sale Warning System is now complete!</strong> üéâ</p>
</body>
</html>